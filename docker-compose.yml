version: '3.3'

services:
  go:
    build:
      context: ./go
      dockerfile: Dockerfile
    image: maxmcd/wasm-servers:go
    volumes:
      - shared:/go/src/github.com/maxmcd/wasm-servers/shared/
  go-print:
    build:
      context: ./programs/go-print
      dockerfile: Dockerfile
    image: maxmcd/wasm-servers:go-print
    volumes:
      - shared:/go/src/github.com/maxmcd/wasm-servers/shared/
  go-fs:
    build:
      context: ./programs/go-fs
      dockerfile: Dockerfile
    image: maxmcd/wasm-servers:go-fs
    volumes:
      - shared:/go/src/github.com/maxmcd/wasm-servers/shared/
  go-net:
    build:
      context: ./programs/go-net
      dockerfile: Dockerfile
    image: maxmcd/wasm-servers:go-net
    volumes:
      - shared:/go/src/github.com/maxmcd/wasm-servers/shared/
  wasabi:
    build:
      context: ./wasabi
      dockerfile: Dockerfile
    image: maxmcd/wasm-servers:wasabi
    volumes:
      - shared:/opt/shared/
      - /home/ubuntu/wasabi-src:/opt/wasabi/src/
      - target:/opt/wasabi/target/

volumes:
  shared:
  target:
